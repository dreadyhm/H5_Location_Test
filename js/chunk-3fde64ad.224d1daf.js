(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3fde64ad"],{"0be1":function(t,i,e){},1072:function(t,i,e){"use strict";e.r(i);var n,o=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{attrs:{id:"FarmlandVisit"}},[e("div",{attrs:{id:"mapDiv"}}),e("div",{staticClass:"bottom-box"},[e("van-button",{staticStyle:{width:"44px"},attrs:{type:"info",icon:"manager-o",round:"",to:"Home"}}),e("van-button",{directives:[{name:"show",rawName:"v-show",value:!t.visiting,expression:"!visiting"}],staticClass:"bottom-button",attrs:{type:"primary",round:""},on:{click:t.startVisit}},[t._v(" 开始巡田 ")]),e("van-button",{directives:[{name:"show",rawName:"v-show",value:t.visiting,expression:"visiting"}],staticClass:"bottom-button report-button",attrs:{type:"warning",round:""},on:{click:t.toEventReport}},[t._v(" 异常上报 ")]),e("van-button",{directives:[{name:"show",rawName:"v-show",value:t.visiting,expression:"visiting"}],staticClass:"bottom-button end-visit-button",attrs:{type:"primary",round:""},on:{click:t.endVisit}},[t._v(" 结束巡田 ")])],1),e("span",{attrs:{id:"mouse-position"}})])},s=[],a=e("ade3"),c=(e("4b0a"),e("2bb1")),r=(e("7844"),e("5596")),l=(e("68ef"),e("9d70"),e("3743"),e("9ee3"),e("d282")),h=e("a142"),u=e("4598"),d=e("5fbe"),f=e("ad06"),v=Object(l["a"])("notice-bar"),m=v[0],p=v[1],g=m({mixins:[Object(d["a"])((function(t){t(window,"pageshow",this.start)}))],inject:{vanPopup:{default:null}},props:{text:String,mode:String,color:String,leftIcon:String,wrapable:Boolean,background:String,scrollable:{type:Boolean,default:null},delay:{type:[Number,String],default:1},speed:{type:[Number,String],default:60}},data:function(){return{show:!0,offset:0,duration:0,wrapWidth:0,contentWidth:0}},watch:{scrollable:"start",text:{handler:"start",immediate:!0}},created:function(){var t=this;this.vanPopup&&this.vanPopup.onReopen((function(){t.start()}))},activated:function(){this.start()},methods:{onClickIcon:function(t){"closeable"===this.mode&&(this.show=!1,this.$emit("close",t))},onTransitionEnd:function(){var t=this;this.offset=this.wrapWidth,this.duration=0,Object(u["c"])((function(){Object(u["b"])((function(){t.offset=-t.contentWidth,t.duration=(t.contentWidth+t.wrapWidth)/t.speed,t.$emit("replay")}))}))},reset:function(){this.offset=0,this.duration=0,this.wrapWidth=0,this.contentWidth=0},start:function(){var t=this,i=Object(h["c"])(this.delay)?1e3*this.delay:0;this.reset(),clearTimeout(this.startTimer),this.startTimer=setTimeout((function(){var i=t.$refs,e=i.wrap,n=i.content;if(e&&n&&!1!==t.scrollable){var o=e.getBoundingClientRect().width,s=n.getBoundingClientRect().width;(t.scrollable||s>o)&&Object(u["b"])((function(){t.offset=-s,t.duration=s/t.speed,t.wrapWidth=o,t.contentWidth=s}))}}),i)}},render:function(){var t=this,i=arguments[0],e=this.slots,n=this.mode,o=this.leftIcon,s=this.onClickIcon,a={color:this.color,background:this.background},c={transform:this.offset?"translateX("+this.offset+"px)":"",transitionDuration:this.duration+"s"};function r(){var t=e("left-icon");return t||(o?i(f["a"],{class:p("left-icon"),attrs:{name:o}}):void 0)}function l(){var t,o=e("right-icon");return o||("closeable"===n?t="cross":"link"===n&&(t="arrow"),t?i(f["a"],{class:p("right-icon"),attrs:{name:t},on:{click:s}}):void 0)}return i("div",{attrs:{role:"alert"},directives:[{name:"show",value:this.show}],class:p({wrapable:this.wrapable}),style:a,on:{click:function(i){t.$emit("click",i)}}},[r(),i("div",{ref:"wrap",class:p("wrap"),attrs:{role:"marquee"}},[i("div",{ref:"content",class:[p("content"),{"van-ellipsis":!1===this.scrollable&&!this.wrapable}],style:c,on:{transitionend:this.onTransitionEnd}},[this.slots()||this.text])]),l()])}}),b=(e("a71a"),e("4d75"),e("e3b3"),e("bc1b"),e("1175"),e("4cf9"),e("2fcb"),e("c31d")),w=e("2b0e"),y=e("2638"),S=e.n(y),C=e("ea8e"),O=e("b1d2"),k=e("6605"),B=e("b650"),x=e("9884"),j=Object(l["a"])("goods-action"),T=j[0],z=j[1],$=T({mixins:[Object(x["b"])("vanGoodsAction")],props:{safeAreaInsetBottom:{type:Boolean,default:!0}},render:function(){var t=arguments[0];return t("div",{class:z({unfit:!this.safeAreaInsetBottom})},[this.slots()])}}),I=e("48f4"),M=Object(l["a"])("goods-action-button"),P=M[0],A=M[1],D=P({mixins:[Object(x["a"])("vanGoodsAction")],props:Object(b["a"])({},I["c"],{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean}),computed:{isFirst:function(){var t=this.parent&&this.parent.children[this.index-1];return!t||t.$options.name!==this.$options.name},isLast:function(){var t=this.parent&&this.parent.children[this.index+1];return!t||t.$options.name!==this.$options.name}},methods:{onClick:function(t){this.$emit("click",t),Object(I["b"])(this.$router,this)}},render:function(){var t=arguments[0];return t(B["a"],{class:A([{first:this.isFirst,last:this.isLast},this.type]),attrs:{size:"large",type:this.type,icon:this.icon,color:this.color,loading:this.loading,disabled:this.disabled},on:{click:this.onClick}},[this.slots()||this.text])}}),N=Object(l["a"])("dialog"),V=N[0],E=N[1],R=N[2],W=V({mixins:[Object(k["a"])()],props:{title:String,theme:String,width:[Number,String],message:String,className:null,callback:Function,beforeClose:Function,messageAlign:String,cancelButtonText:String,cancelButtonColor:String,confirmButtonText:String,confirmButtonColor:String,showCancelButton:Boolean,overlay:{type:Boolean,default:!0},allowHtml:{type:Boolean,default:!0},transition:{type:String,default:"van-dialog-bounce"},showConfirmButton:{type:Boolean,default:!0},closeOnPopstate:{type:Boolean,default:!0},closeOnClickOverlay:{type:Boolean,default:!1}},data:function(){return{loading:{confirm:!1,cancel:!1}}},methods:{onClickOverlay:function(){this.handleAction("overlay")},handleAction:function(t){var i=this;this.$emit(t),this.value&&(this.beforeClose?(this.loading[t]=!0,this.beforeClose(t,(function(e){!1!==e&&i.loading[t]&&i.onClose(t),i.loading.confirm=!1,i.loading.cancel=!1}))):this.onClose(t))},onClose:function(t){this.close(),this.callback&&this.callback(t)},onOpened:function(){this.$emit("opened")},onClosed:function(){this.$emit("closed")},genRoundButtons:function(){var t=this,i=this.$createElement;return i($,{class:E("footer")},[this.showCancelButton&&i(D,{attrs:{size:"large",type:"warning",text:this.cancelButtonText||R("cancel"),color:this.cancelButtonColor,loading:this.loading.cancel},class:E("cancel"),on:{click:function(){t.handleAction("cancel")}}}),this.showConfirmButton&&i(D,{attrs:{size:"large",type:"danger",text:this.confirmButtonText||R("confirm"),color:this.confirmButtonColor,loading:this.loading.confirm},class:E("confirm"),on:{click:function(){t.handleAction("confirm")}}})])},genButtons:function(){var t,i=this,e=this.$createElement,n=this.showCancelButton&&this.showConfirmButton;return e("div",{class:[O["e"],E("footer")]},[this.showCancelButton&&e(B["a"],{attrs:{size:"large",loading:this.loading.cancel,text:this.cancelButtonText||R("cancel")},class:E("cancel"),style:{color:this.cancelButtonColor},on:{click:function(){i.handleAction("cancel")}}}),this.showConfirmButton&&e(B["a"],{attrs:{size:"large",loading:this.loading.confirm,text:this.confirmButtonText||R("confirm")},class:[E("confirm"),(t={},t[O["c"]]=n,t)],style:{color:this.confirmButtonColor},on:{click:function(){i.handleAction("confirm")}}})])},genContent:function(t,i){var e=this.$createElement;if(i)return e("div",{class:E("content")},[i]);var n=this.message,o=this.messageAlign;if(n){var s,a,c={class:E("message",(s={"has-title":t},s[o]=o,s)),domProps:(a={},a[this.allowHtml?"innerHTML":"textContent"]=n,a)};return e("div",{class:E("content",{isolated:!t})},[e("div",S()([{},c]))])}}},render:function(){var t=arguments[0];if(this.shouldRender){var i=this.message,e=this.slots(),n=this.slots("title")||this.title,o=n&&t("div",{class:E("header",{isolated:!i&&!e})},[n]);return t("transition",{attrs:{name:this.transition},on:{afterEnter:this.onOpened,afterLeave:this.onClosed}},[t("div",{directives:[{name:"show",value:this.value}],attrs:{role:"dialog","aria-labelledby":this.title||i},class:[E([this.theme]),this.className],style:{width:Object(C["a"])(this.width)}},[o,this.genContent(n,e),"round-button"===this.theme?this.genRoundButtons():this.genButtons()])])}}});function L(t){return document.body.contains(t)}function _(){n&&n.$destroy(),n=new(w["a"].extend(W))({el:document.createElement("div"),propsData:{lazyRender:!1}}),n.$on("input",(function(t){n.value=t}))}function H(t){return h["g"]?Promise.resolve():new Promise((function(i,e){n&&L(n.$el)||_(),Object(b["a"])(n,H.currentOptions,t,{resolve:i,reject:e})}))}H.defaultOptions={value:!0,title:"",width:"",theme:null,message:"",overlay:!0,className:"",allowHtml:!0,lockScroll:!0,transition:"van-dialog-bounce",beforeClose:null,overlayClass:"",overlayStyle:null,messageAlign:"",getContainer:"body",cancelButtonText:"",cancelButtonColor:null,confirmButtonText:"",confirmButtonColor:null,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1,callback:function(t){n["confirm"===t?"resolve":"reject"](t)}},H.alert=H,H.confirm=function(t){return H(Object(b["a"])({showCancelButton:!0},t))},H.close=function(){n&&(n.value=!1)},H.setDefaultOptions=function(t){Object(b["a"])(H.currentOptions,t)},H.resetDefaultOptions=function(){H.currentOptions=Object(b["a"])({},H.defaultOptions)},H.resetDefaultOptions(),H.install=function(){w["a"].use(W)},H.Component=W,w["a"].prototype.$dialog=H;var F,X=H,Y=(e("66b9"),e("b0c0"),e("f3d4")),Z=e("a745"),J={name:"FarmlandVisit",components:(F={},Object(a["a"])(F,B["a"].name,B["a"]),Object(a["a"])(F,X.Component.name,X.Component),Object(a["a"])(F,g.name,g),Object(a["a"])(F,r["a"].name,r["a"]),Object(a["a"])(F,c["a"].name,c["a"]),F),data:function(){return{tzMapSdk:"",visiting:!1,visitId:"",continueCreate:!1,watchID:"",locations:[],vmPosition:[]}},created:function(){Y["a"].reSetNavBar(),Y["a"].setNavBarShow(!1)},mounted:function(){this.initMap()},activated:function(){Y["a"].reSetNavBar(),Y["a"].setNavBarShow(!1)},methods:{initMap:function(){var t="http://192.168.1.182:6080/arcgis/rest/services/TZ_TZZ_SLTC/TZZ_SLTC_20211008/MapServer";this.tzMapSdk=new tzMapSdkClass,this.tzMapSdk.addProj_4490(),this.tzMapSdk.TianDiTuMapInit("mapDiv","vec_c","081d834fc861ac849b217652992982a7",void 0,[106.17,26.16],14),this.tzMapSdk.addTianDiTuLayer("cva_c","081d834fc861ac849b217652992982a7","cva_c"),this.tzMapSdk.addDynamicArcGISRestLayer(t,"dynamic","7,4"),this.tzMapSdk.setVectorLayerIndex(1e3)},startLocation:function(){var t=this;if("geolocation"in navigator){if(this.watchID)return;this.watchID=navigator.geolocation.watchPosition((function(i){t.tzMapSdk.clearVectorLayer(),t.tzMapSdk.removePlacemark("mark1"),t.visiting||(t.visiting=!0);var e=[i.coords.longitude,i.coords.latitude];t.locations.push(e),t.tzMapSdk.addVectorPolyline(t.locations,void 0,void 0,{lineColor:"green",width:4}),t.tzMapSdk.centerAt(e),t.tzMapSdk.addPlacemark(e,"mark1"),Object(Z["f"])({id:t.visitId,route:JSON.stringify(e)}).then((function(t){t.success&&console.log(t)}))}),(function(i){var e="获取地理位置超时";switch(i.code){case 1:e="没有获取地理位置信息的权限";break;case 2:e="获取地理位置出错";break}t.$toast.fail(e)}),{enableHighAccuracy:!0,timeout:3e4,maximumAge:0})}else this.$toast("地理位置服务不可用")},createVisitId:function(){var t=this;Object(Z["a"])().then((function(i){i.success&&(t.visitId=i.data,t.startLocation())}))},startVisit:function(){var t=this;Object(Z["c"])().then((function(i){i.success?i.data?(t.visitId=i.data.id,X.confirm({title:"提示",message:"上一次巡查未结束，是否继续",confirmButtonText:"继续",cancelButtonText:"开启新的巡查"}).then((function(){var e;t.locations=JSON.parse(null!==(e=i.data.route)&&void 0!==e?e:[]),t.visiting=!0,t.startLocation()})).catch((function(){t.continueCreate=!0,t.visiting=!0,t.endVisit()}))):t.createVisitId():t.$toast.fail(i.msg)}))},endVisit:function(){var t=this;this.visiting&&Object(Z["b"])(this.visitId).then((function(i){i.success?(t.visiting=!1,navigator.geolocation.clearWatch(t.watchID),t.watchID="",t.locations=[],t.visitId="",t.continueCreate&&(t.continueCreate=!1,t.createVisitId()),t.tzMapSdk.clearVectorLayer()):t.$toast.fail(i.msg)}))},toEventReport:function(){this.$router.push({name:"EventReport",query:{visitId:this.visitId,lon:this.locations[this.locations.length-1][0],lat:this.locations[this.locations.length-1][1]}})}}},q=J,G=(e("509f"),e("2877")),K=Object(G["a"])(q,o,s,!1,null,"1774c2bf",null);i["default"]=K.exports},1175:function(t,i,e){},"2bb1":function(t,i,e){"use strict";var n=e("c31d"),o=e("d282"),s=e("9884"),a=Object(o["a"])("swipe-item"),c=a[0],r=a[1];i["a"]=c({mixins:[Object(s["a"])("vanSwipe")],data:function(){return{offset:0,inited:!1,mounted:!1}},mounted:function(){var t=this;this.$nextTick((function(){t.mounted=!0}))},computed:{style:function(){var t={},i=this.parent,e=i.size,n=i.vertical;return e&&(t[n?"height":"width"]=e+"px"),this.offset&&(t.transform="translate"+(n?"Y":"X")+"("+this.offset+"px)"),t},shouldRender:function(){var t=this.index,i=this.inited,e=this.parent,n=this.mounted;if(!e.lazyRender||i)return!0;if(!n)return!1;var o=e.activeIndicator,s=e.count-1,a=0===o&&e.loop?s:o-1,c=o===s&&e.loop?0:o+1,r=t===o||t===a||t===c;return r&&(this.inited=!0),r}},render:function(){var t=arguments[0];return t("div",{class:r(),style:this.style,on:Object(n["a"])({},this.$listeners)},[this.shouldRender&&this.slots()])}})},"2fcb":function(t,i,e){},4598:function(t,i,e){"use strict";(function(t){e.d(i,"c",(function(){return l})),e.d(i,"b",(function(){return h})),e.d(i,"a",(function(){return u}));var n=e("a142"),o=Date.now();function s(t){var i=Date.now(),e=Math.max(0,16-(i-o)),n=setTimeout(t,e);return o=i+e,n}var a=n["g"]?t:window,c=a.requestAnimationFrame||s,r=a.cancelAnimationFrame||a.clearTimeout;function l(t){return c.call(a,t)}function h(t){l((function(){l(t)}))}function u(t){r.call(a,t)}}).call(this,e("c8ba"))},"4b0a":function(t,i,e){"use strict";e("68ef"),e("786d")},"4cf9":function(t,i,e){},"509f":function(t,i,e){"use strict";e("0be1")},5596:function(t,i,e){"use strict";var n=e("d282"),o=e("02de"),s=e("1325"),a=e("4598"),c=e("482d"),r=e("3875"),l=e("9884"),h=e("5fbe"),u=Object(n["a"])("swipe"),d=u[0],f=u[1];i["a"]=d({mixins:[r["a"],Object(l["b"])("vanSwipe"),Object(h["a"])((function(t,i){t(window,"resize",this.resize,!0),t(window,"orientationchange",this.resize,!0),t(window,"visibilitychange",this.onVisibilityChange),i?this.initialize():this.clear()}))],props:{width:[Number,String],height:[Number,String],autoplay:[Number,String],vertical:Boolean,lazyRender:Boolean,indicatorColor:String,loop:{type:Boolean,default:!0},duration:{type:[Number,String],default:500},touchable:{type:Boolean,default:!0},initialSwipe:{type:[Number,String],default:0},showIndicators:{type:Boolean,default:!0},stopPropagation:{type:Boolean,default:!0}},data:function(){return{rect:null,offset:0,active:0,deltaX:0,deltaY:0,swiping:!1,computedWidth:0,computedHeight:0}},watch:{children:function(){this.initialize()},initialSwipe:function(){this.initialize()},autoplay:function(t){t>0?this.autoPlay():this.clear()}},computed:{count:function(){return this.children.length},maxCount:function(){return Math.ceil(Math.abs(this.minOffset)/this.size)},delta:function(){return this.vertical?this.deltaY:this.deltaX},size:function(){return this[this.vertical?"computedHeight":"computedWidth"]},trackSize:function(){return this.count*this.size},activeIndicator:function(){return(this.active+this.count)%this.count},isCorrectDirection:function(){var t=this.vertical?"vertical":"horizontal";return this.direction===t},trackStyle:function(){var t={transitionDuration:(this.swiping?0:this.duration)+"ms",transform:"translate"+(this.vertical?"Y":"X")+"("+this.offset+"px)"};if(this.size){var i=this.vertical?"height":"width",e=this.vertical?"width":"height";t[i]=this.trackSize+"px",t[e]=this[e]?this[e]+"px":""}return t},indicatorStyle:function(){return{backgroundColor:this.indicatorColor}},minOffset:function(){return(this.vertical?this.rect.height:this.rect.width)-this.size*this.count}},mounted:function(){this.bindTouchEvent(this.$refs.track)},methods:{initialize:function(t){if(void 0===t&&(t=+this.initialSwipe),this.$el&&!Object(o["a"])(this.$el)){clearTimeout(this.timer);var i={width:this.$el.offsetWidth,height:this.$el.offsetHeight};this.rect=i,this.swiping=!0,this.active=t,this.computedWidth=+this.width||i.width,this.computedHeight=+this.height||i.height,this.offset=this.getTargetOffset(t),this.children.forEach((function(t){t.offset=0})),this.autoPlay()}},resize:function(){this.initialize(this.activeIndicator)},onVisibilityChange:function(){document.hidden?this.clear():this.autoPlay()},onTouchStart:function(t){this.touchable&&(this.clear(),this.touchStartTime=Date.now(),this.touchStart(t),this.correctPosition())},onTouchMove:function(t){this.touchable&&this.swiping&&(this.touchMove(t),this.isCorrectDirection&&(Object(s["c"])(t,this.stopPropagation),this.move({offset:this.delta})))},onTouchEnd:function(){if(this.touchable&&this.swiping){var t=this.size,i=this.delta,e=Date.now()-this.touchStartTime,n=i/e,o=Math.abs(n)>.25||Math.abs(i)>t/2;if(o&&this.isCorrectDirection){var s=this.vertical?this.offsetY:this.offsetX,a=0;a=this.loop?s>0?i>0?-1:1:0:-Math[i>0?"ceil":"floor"](i/t),this.move({pace:a,emitChange:!0})}else i&&this.move({pace:0});this.swiping=!1,this.autoPlay()}},getTargetActive:function(t){var i=this.active,e=this.count,n=this.maxCount;return t?this.loop?Object(c["b"])(i+t,-1,e):Object(c["b"])(i+t,0,n):i},getTargetOffset:function(t,i){void 0===i&&(i=0);var e=t*this.size;this.loop||(e=Math.min(e,-this.minOffset));var n=i-e;return this.loop||(n=Object(c["b"])(n,this.minOffset,0)),n},move:function(t){var i=t.pace,e=void 0===i?0:i,n=t.offset,o=void 0===n?0:n,s=t.emitChange,a=this.loop,c=this.count,r=this.active,l=this.children,h=this.trackSize,u=this.minOffset;if(!(c<=1)){var d=this.getTargetActive(e),f=this.getTargetOffset(d,o);if(a){if(l[0]&&f!==u){var v=f<u;l[0].offset=v?h:0}if(l[c-1]&&0!==f){var m=f>0;l[c-1].offset=m?-h:0}}this.active=d,this.offset=f,s&&d!==r&&this.$emit("change",this.activeIndicator)}},prev:function(){var t=this;this.correctPosition(),this.resetTouchStatus(),Object(a["b"])((function(){t.swiping=!1,t.move({pace:-1,emitChange:!0})}))},next:function(){var t=this;this.correctPosition(),this.resetTouchStatus(),Object(a["b"])((function(){t.swiping=!1,t.move({pace:1,emitChange:!0})}))},swipeTo:function(t,i){var e=this;void 0===i&&(i={}),this.correctPosition(),this.resetTouchStatus(),Object(a["b"])((function(){var n;n=e.loop&&t===e.count?0===e.active?0:t:t%e.count,i.immediate?Object(a["b"])((function(){e.swiping=!1})):e.swiping=!1,e.move({pace:n-e.active,emitChange:!0})}))},correctPosition:function(){this.swiping=!0,this.active<=-1&&this.move({pace:this.count}),this.active>=this.count&&this.move({pace:-this.count})},clear:function(){clearTimeout(this.timer)},autoPlay:function(){var t=this,i=this.autoplay;i>0&&this.count>1&&(this.clear(),this.timer=setTimeout((function(){t.next(),t.autoPlay()}),i))},genIndicator:function(){var t=this,i=this.$createElement,e=this.count,n=this.activeIndicator,o=this.slots("indicator");return o||(this.showIndicators&&e>1?i("div",{class:f("indicators",{vertical:this.vertical})},[Array.apply(void 0,Array(e)).map((function(e,o){return i("i",{class:f("indicator",{active:o===n}),style:o===n?t.indicatorStyle:null})}))]):void 0)}},render:function(){var t=arguments[0];return t("div",{class:f()},[t("div",{ref:"track",style:this.trackStyle,class:f("track",{vertical:this.vertical})},[this.slots()]),this.genIndicator()])}})},7844:function(t,i,e){"use strict";e("68ef"),e("8270")},"786d":function(t,i,e){},8270:function(t,i,e){},"9ee3":function(t,i,e){}}]);